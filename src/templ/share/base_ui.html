{% extends "share/base.html" %}
{%block code %}
<script type="text/javascript">
   function _i(message) {
   	  $('#notification').jnotifyAddMessage({
          text: message,
          permanent: false,
          type: 'info'
      });
   }
   function _e(message) {
   	  $('#notification').jnotifyAddMessage({
          text: message,
          permanent: true,
          type: 'error'
      });
   }
$(function() {
   $("input:submit, input:button, a",".button").button();
   $('#notification').jnotifyInizialize({
      oneAtTime: false,
      appendType: 'append'
   }).css({
      'font-size': "120%",
      'position': 'absolute',
      'marginTop': '20px',
      'padding': '15px',
      'right': '20px',
      'width': '250px',
      'z-index': '9999'
   });
   $('.tip').tooltip({showURL: false});
   stomp = new STOMPClient();
   {% if debug %}
   stomp.onopen = function() {
       $('#notification').jnotifyAddMessage({
          text: "STOMP connection opened",
          permanent: false,
          type: 'info'
       });
   };
   stomp.onclose = function(c) { 
       $('#notification').jnotifyAddMessage({
          text: "STOMP connection lost: "+c,
          permanent: true,
          type: 'error'
       });
   };
   {% endif %}
   stomp.onerror = function(error) {
       $('#notification').jnotifyAddMessage({
          text: error,
          permanent: true,
          type: 'error'
       });
   };
   stomp.onerrorframe = function(frame) {
       $('#notification').jnotifyAddMessage({
          text: frame.body,
          permanent: true,
          type: 'error'
       });
   };
   stomp.onconnectedframe = function() {
       stomp.subscribe("/session/"+$.cookie("sessionid"));
   };
   stomp.onmessageframe = function(frame) {
       $('#notification').jnotifyAddMessage({
          text: frame.body,
          permanent: false,
          type: 'info'
       });
   };
   stomp.connect('{{stomp_host}}', {{stomp_port}});
});
</script>
{% block js %}{% endblock %}
{% endblock %}

{% block body %}
<div id="notification"></div>
{% if error %}
<script type="text/javascript">
$(function() {
   $('#notification').jnotifyAddMessage({
      text: {{error}},
      permanent: false,
      type: 'error'
   });
});
</script>
{% endif %}
<div id="header">
   {% if user.is_authenticated %}
   <div style="float: right; margin-right: 50px;" class="button"><a id="logout" href="/auth/logout/">Logout</a></div>
   <div id="linklist">
      <ul>
         <li><a href="/user"><span class="ui-icon ui-icon-locked" style="float: left;"></span>{{ user.get_full_name }}</a></li>
      </ul>
   {% endif %}
   </div>
   <div id="branding"><a style="text-decoration: none" href="/">{% block title %}{% endblock %}</a></div>
</div>
<div class="clear"></div>
<div id="content">
	<div id="main">
	   	{% block main %}{% endblock %}
	</div>
	<div id="rhs">
	    {% block rhs %}{% endblock %}
	</div>
	<div class="clear"></div>
</div>
<div class="clear"></div>
<div id="footer">
   <ul>
     <li><a href="#about">About Lobber</a></li>
     <li><a href="#about">Terms Of Use</a></li>
     <li><a href="#about">System Status</a></li>
   </ul>
</div>
{% endblock %}
